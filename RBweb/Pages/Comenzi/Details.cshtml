@page "{id:int}"
@model RBweb.Pages.Comenzi.DetailsModel

@functions {
    string BadgeClass(string status) => status switch
    {
        "Noua" => "bg-secondary",
        "InLucru" => "bg-warning text-dark",
        "Finalizata" => "bg-success",
        "Anulata" => "bg-danger",
        _ => "bg-secondary"
    };
}

<h2 class="mb-3">Detalii comandă</h2>

<div class="card shadow-sm mb-4">
    <div class="card-body d-flex justify-content-between align-items-center flex-wrap">
        <div>
            <div class="text-muted small">Nr. comandă</div>
            <div class="fw-semibold">@Model.Comanda.NumarComanda</div>

            <div class="text-muted small mt-2">Data</div>
            <div class="fw-semibold">@Model.Comanda.DataComanda.ToString("dd.MM.yyyy HH:mm")</div>
        </div>

        <div class="mt-3 mt-md-0 text-end">
            <div class="text-muted small">Status</div>
            <span class="badge @BadgeClass(Model.Comanda.Status.ToString()) px-3 py-2">
                @Model.Comanda.Status
            </span>
        </div>
    </div>
</div>

<div class="card shadow-sm">
    <div class="card-body">
        <h5 class="mb-3">Produse comandate</h5>

        <div class="table-responsive">
            <table class="table align-middle">
                <thead>
                    <tr>
                        <th>Produs</th>
                        <th class="text-end">Preț</th>
                        <th class="text-end">Cantitate</th>
                        <th class="text-end">Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Comanda.Items)
                    {
                        var pret = item.Meniu?.Pret ?? 0m;
                        <tr>
                            <td class="fw-semibold">@item.Meniu?.Denumire</td>
                            <td class="text-end">@pret.ToString("0.00") lei</td>
                            <td class="text-end">@item.Cantitate</td>
                            <td class="text-end">@((pret * item.Cantitate).ToString("0.00")) lei</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-3">
            <h4 class="m-0">Total: @Model.Total.ToString("0.00") lei</h4>
            <a class="btn btn-outline-secondary" asp-page="/Comenzi/ComenzileMele">Înapoi</a>
        </div>
    </div>
</div>
